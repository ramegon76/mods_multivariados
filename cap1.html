<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Análisis Multivariado</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MAEC MEM Proyecto Final <br></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
    Presentación
  </a>
</li>
<li>
  <a href="cap1.html">
    <span class="fas fa-tasks"></span>
     
    Análisis Multivariado
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><strong>Análisis Multivariado</strong></h1>

</div>


<div class=text-justify>

<p><br> <br> <br></p>
<div id="análisis-de-correspondencias-de-las-variables-condición-de-actividad-de-la-persona-p3_7-y-destino-de-los-viajes-realizados-p5_11a." class="section level2">
<h2><strong>1. Análisis de Correspondencias de las Variables: Condición de actividad de la persona (P3_7), y Destino de los viajes realizados (P5_11A).</strong></h2>
<p><br></p>
<div id="metodología." class="section level3">
<h3>Metodología.</h3>
<p><br></p>
<p>Se inicia con un análisis de correspondencias entre la variable de condición de actividad de la persona (pregunta P3_7) y el destino de sus viajes realizados (P5_11A), con la intención de indagar la relación existente entre estos datos.</p>
<p>Las categorías de la variable Condición de Actividad son:</p>
<ul>
<li>1 Trabajó<br />
</li>
<li>2 Tenía trabajo, pero no trabajó<br />
</li>
<li>3 Buscó trabajo<br />
</li>
<li>4 Es estudiante<br />
</li>
<li>5 Se dedica a los quehaceres del hogar o a cuidar a sus hijos<br />
</li>
<li>6 Es jubilado(a) o pensionado(a)<br />
</li>
<li>7 Está incapacitado(a) permanentemente para trabajar<br />
</li>
<li>8 No trabajó</li>
</ul>
<p>Mientras que las de la variable Destino del viaje son:</p>
<ul>
<li>01 Su hogar<br />
</li>
<li>02 Escuela<br />
</li>
<li>03 Oficina<br />
</li>
<li>04 Fábrica o taller<br />
</li>
<li>05 Comercio, mercado, tienda o centro comercial<br />
</li>
<li>06 Centro cultural o área recreativa<br />
</li>
<li>07 Otra vivienda<br />
</li>
<li>08 Hospital, clínica, consultorio, laboratorio clínico<br />
</li>
<li>09 Restaurante, bar, cafetería<br />
</li>
<li>10 Deportivo, gimnasio<br />
</li>
<li>11 Bases o estaciones de transporte público<br />
</li>
<li>12 Obra en construcción<br />
</li>
<li>13 Otros servicios<br />
</li>
<li>14 Recinto religioso<br />
</li>
<li>15 Vía pública<br />
</li>
<li>16 Otro<br />
</li>
<li>99 No sabe</li>
</ul>
<p><br></p>
<p>Se comienza, por lo tanto, leyendo los datos y adjuntando la variable P3_7 de la tabla TSDem a la tabla TViaje:</p>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>viajes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bd/tviaje2.csv&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tsdem <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bd/tsdem.csv&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sqldf)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>viajes2 <span class="ot">&lt;-</span> <span class="fu">sqldf</span>(<span class="st">&quot;SELECT viajes.*, tsdem.niv, tsdem.p3_7 FROM viajes LEFT JOIN</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">                 tsdem ON viajes.id_soc = tsdem.id_soc&quot;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(viajes)</span></code></pre></div>
<p><br></p>
<p>Luego, con ello se arma la matriz de datos y se analizan su independencia con la prueba de <span class="math inline">\(\chi^2\)</span>:</p>
<p><br></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se genera la tabla de contingencia entre las variables seleccionadas</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>analisis_1<span class="ot">&lt;-</span><span class="fu">table</span>(viajes2<span class="sc">$</span>p3_7, viajes2<span class="sc">$</span>p5_11a)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(analisis_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Trabajo&quot;</span>,<span class="st">&quot;Tenia trabajo pero no...&quot;</span>,<span class="st">&quot;Busco trabajo&quot;</span>,<span class="st">&quot;Estudio&quot;</span>,<span class="st">&quot;Hogar&quot;</span>,<span class="st">&quot;Jubilado&quot;</span>,<span class="st">&quot;Incapacitado&quot;</span>,<span class="st">&quot;No trabajo&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(analisis_1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Hogar&quot;</span>,<span class="st">&quot;Escuela&quot;</span>,<span class="st">&quot;Oficina&quot;</span>,<span class="st">&quot;Fabrica/taller&quot;</span>,<span class="st">&quot;Comercio&quot;</span>,<span class="st">&quot;Centro Cultural &quot;</span>,<span class="st">&quot;Otra vivienda&quot;</span>,<span class="st">&quot;Hosp. Clinica o Lab&quot;</span>,<span class="st">&quot;Restaurant&quot;</span>,<span class="st">&quot;Deportivo,Gym&quot;</span>,<span class="st">&quot;Bases Transp. Pub,&quot;</span>,<span class="st">&quot;Obra en Const.&quot;</span>,<span class="st">&quot;Otros serv.&quot;</span>,<span class="st">&quot;Recint. Relig.&quot;</span>,<span class="st">&quot;Via Publica&quot;</span>,<span class="st">&quot;Otro&quot;</span>,<span class="st">&quot;No sabe&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla de contingencia:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>analisis_1</span></code></pre></div>
<pre><code>##                           
##                             Hogar Escuela Oficina Fabrica/taller Comercio Centro Cultural 
##   Trabajo                  132148   12877   30884          19345    46981             6007
##   Tenia trabajo pero no...   1180     184     119             93      438               50
##   Busco trabajo              2651     410     336            181     1030              208
##   Estudio                   34224   23404     777            313     5390             2758
##   Hogar                     37194   11229     619            295    18946             1622
##   Jubilado                   9286     635     483            108     4686              853
##   Incapacitado                895      64      39             14      361               68
##   No trabajo                11022    2362     422            261     5074              788
##                           
##                            Otra vivienda Hosp. Clinica o Lab Restaurant Deportivo,Gym
##   Trabajo                          15707                5582       2379          1051
##   Tenia trabajo pero no...           204                 143         24             9
##   Busco trabajo                      478                 119         38            29
##   Estudio                           3098                 578        319           482
##   Hogar                             4501                2035        254           210
##   Jubilado                          1485                1257        268           105
##   Incapacitado                       128                 230         17            10
##   No trabajo                        1635                 923        126           104
##                           
##                            Bases Transp. Pub, Obra en Const. Otros serv. Recint. Relig. Via Publica
##   Trabajo                                2674           1153         751           1090        1253
##   Tenia trabajo pero no...                 17             13          10             15           6
##   Busco trabajo                            33             13          16             36           9
##   Estudio                                  88             16         139            301          52
##   Hogar                                   106              4         120            686         116
##   Jubilado                                 84              6          45            277          39
##   Incapacitado                              6              7           4             27          12
##   No trabajo                               76             29          56            242          59
##                           
##                              Otro No sabe
##   Trabajo                    4079     498
##   Tenia trabajo pero no...     34       5
##   Busco trabajo                85      12
##   Estudio                     245      97
##   Hogar                       457     249
##   Jubilado                    283      50
##   Incapacitado                 24       2
##   No trabajo                  249      73</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>chiR<span class="ot">&lt;-</span><span class="fu">chisq.test</span>(analisis_1)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Inercia total medida de la variabilidad de los datos en la tabla</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">sum</span>(analisis_1)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>inetot<span class="ot">&lt;-</span>chiR<span class="sc">$</span>statistic<span class="sc">/</span>n</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chiR)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  analisis_1
## X-squared = 88548, df = 112, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(inetot)</span></code></pre></div>
<pre><code>## X-squared 
## 0.1810906</code></pre>
<p><br></p>
<p>Por el p-valor se rechaza <span class="math inline">\(H_0\)</span>, lo que establece que las variables analizadas son dependientes.</p>
<p><br> <br></p>
</div>
<div id="resultados." class="section level3">
<h3>Resultados.</h3>
<p><br></p>
<p>Se genera la proyección conjunta de los datos en dos dimensiones:</p>
<p><br></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ca&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>corres <span class="ot">&lt;-</span><span class="fu">ca</span> (analisis_1,<span class="at">nd=</span><span class="dv">2</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(corres)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Presenta informacion del modelo de análisis de correspondencia</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>corres</span></code></pre></div>
<pre><code>## 
##  Principal inertias (eigenvalues):
##            1        2        3       4        5        6       7      
## Value      0.139003 0.036202 0.00495 0.000638 0.000217 6.2e-05 1.7e-05
## Percentage 76.76%   19.99%   2.73%   0.35%    0.12%    0.03%   0.01%  
## 
## 
##  Rows:
##           Trabajo Tenia trabajo pero no... Busco trabajo  Estudio     Hogar  Jubilado Incapacitado
## Mass     0.581751                 0.005203      0.011624 0.147823  0.160834  0.040800     0.003902
## ChiDist  0.279694                 0.295264      0.192575 0.794118  0.386925  0.503333     0.758580
## Inertia  0.045510                 0.000454      0.000431 0.093221  0.024079  0.010336     0.002245
## Dim. 1  -0.716012                -0.170514     -0.130360 2.049247  0.679787 -0.186131    -0.205301
## Dim. 2   0.437988                -0.934589     -0.541033 1.120821 -1.428662 -2.367958    -2.718875
##         No trabajo
## Mass      0.048062
## ChiDist   0.316522
## Inertia   0.004815
## Dim. 1    0.313769
## Dim. 2   -1.504969
## 
## 
##  Columns:
##             Hogar  Escuela   Oficina Fabrica/taller  Comercio Centro Cultural  Otra vivienda
## Mass     0.467513 0.104638  0.068877       0.042150  0.169552         0.025265      0.055701
## ChiDist  0.008413 0.938255  0.686142       0.729330  0.291595         0.295874      0.140737
## Inertia  0.000033 0.092116  0.032427       0.022420  0.014417         0.002212      0.001103
## Dim. 1   0.021087 2.458534 -1.603133      -1.690494 -0.300147         0.541088     -0.169866
## Dim. 2  -0.010266 1.048070  1.768948       1.920421 -1.339493        -0.061688     -0.550535
##         Hosp. Clinica o Lab Restaurant Deportivo,Gym Bases Transp. Pub, Obra en Const. Otros serv.
## Mass               0.022224   0.007005      0.004090           0.006307       0.002538    0.002333
## ChiDist            0.571977   0.356065      0.297232           0.593811       0.731858    0.192152
## Inertia            0.007271   0.000888      0.000361           0.002224       0.001359    0.000086
## Dim. 1            -0.360460  -0.704730      0.514553          -1.445843      -1.701857   -0.391919
## Dim. 2            -2.419962   0.189032      0.641463           1.286723       1.783612    0.431005
##         Recint. Relig. Via Publica      Otro   No sabe
## Mass          0.005469    0.003162  0.011158  0.002016
## ChiDist       0.511611    0.488817  0.400770  0.310329
## Inertia       0.001431    0.000755  0.001792  0.000194
## Dim. 1        0.315245   -1.223383 -1.034447  0.060501
## Dim. 2       -2.540051    0.738081  0.212281 -1.459255</code></pre>
<p><br></p>
</div>
<div id="interpretación." class="section level3">
<h3>Interpretación.</h3>
<p><br></p>
<p>La dimensión 2 actúa como un discriminante a pesar del poco valor de variabilidad (20%) ya que los valores mas altos (extremos) se presentan en la parte superior de la gráfica. La dimension 1 representa el 76.8% de la variabilidad de los datos.</p>
<p><br></p>
<div id="analisis-de-la-gráfica-de-correspondencia." class="section level4">
<h4><em>Analisis de la gráfica de correspondencia.</em></h4>
<p><em>Cuadrante I</em></p>
<p>Se observa que las personas que se dedican a los quehaceres del hogar y que no tienen trabajo, tienen como destino más común su hogar, centro cultural o área recreativa, los recintos religiosos y algunos no lo saben.</p>
<p><em>Cuadrante II</em></p>
<p>Cuando la persona que viaja busca trabajo, tenia trabajo, pero no trabajó, es jubilada o pensionada, o está incapacitada permanentemente para trabajar, tiene como destino los mercados, comercios,tienda o centro comercial, y hospitales, clínicas, consultorios, etc.</p>
<p><em>Cuadrante III</em></p>
<p>Cuando la persona que viaja tiene trabajo, sus destinos mas frecuentes son: Fábrica/taller, Hogar, escuela, oficina, estaciones de transporte público, vía pública, otros lugares, restaurantes, bar, cafetería y otros servicios.</p>
<p><em>Cuadrante IV</em></p>
<p>Cuando se es estudiante, los destinos mas frecuentes son: Deportivo/gimnasio y Escuela.</p>
<p>Al ser las variables analizadas dependientes conforme a la prueba de hipotesis <span class="math inline">\(\chi^2\)</span>.</p>
<p><br></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>via <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bd/tviaje3.csv&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>viajes3 <span class="ot">&lt;-</span> <span class="fu">sqldf</span>(<span class="st">&quot;SELECT via.*, tsdem.p3_7 FROM via LEFT JOIN</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="st">                 tsdem ON via.id_soc = tsdem.id_soc&quot;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(via)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de dia del viaje y condicion de actividad del pasajero</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>analisis_2<span class="ot">&lt;-</span><span class="fu">table</span>(viajes3<span class="sc">$</span>p5_3, viajes3<span class="sc">$</span>p3_7)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(analisis_2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;viaje entre semana&quot;</span>,<span class="st">&quot;viaje en sabado&quot;</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(analisis_2,<span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;trabajo&quot;</span>,<span class="st">&quot;tenia_trab&quot;</span>,<span class="st">&quot;busca&quot;</span>,<span class="st">&quot;estudia&quot;</span>,<span class="st">&quot;hogar&quot;</span>,<span class="st">&quot;jubilado&quot;</span>,<span class="st">&quot;incap.&quot;</span>,<span class="st">&quot;no trab&quot;</span>),<span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.5</span>),<span class="at">legend=</span><span class="cn">TRUE</span>,<span class="at">xlab=</span><span class="st">&quot;Condicion de actividad&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Frecuencia relativa&quot;</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;orange&quot;</span>),<span class="at">main=</span><span class="st">&quot;Viajes de personas por día según condición de actividad&quot;</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><br></p>
</div>
</div>
<div id="conclusión." class="section level3">
<h3>Conclusión.</h3>
<p>En el análisis multivariado es importante tener una visión rápida y de preferencia gráfica del comportamiento de los datos. En nuestro caso, para las dos variables seleccionadas, condición de actividad de la persona (P3_7) y destino de los viajes realizados (P5_11A), una de estas técnicas descriptivas que se adecua muy bien es el análisis de correspondencias, el cual nos permite elaborar un mapa perceptual de las categorías de las variables analizadas en un espacio de pocas dimensiones (2), ya que con dichas dimensiones se tiene un porcentaje alto de variabilidad explicada (96.8%), lo facilita su interpretación gráfica, en donde la mayor o menor distancia entre los puntos reflejan cierto grado de asociación entre las categorías representadas. Seleccionamos esta técnica de análisis porque se aplica a variables categóricas.</p>
<p><br> <br> <br></p>
</div>
</div>
<div id="análisis-de-correspondencias-de-las-variables-estrato-sociodemográfico-estrato-y-duración-del-viaje." class="section level2">
<h2><strong>2. Análisis de correspondencias de las variables: Estrato sociodemográfico (Estrato), y duración del viaje.</strong></h2>
<p><br></p>
<div id="metodología.-1" class="section level3">
<h3>Metodología.</h3>
<p><br></p>
<p>La duración de los viajes es una variable que se captó de forma indirecta, ya que se recopilaron los datos de las horas de inicio y fin de cada viaje. La suposición inicial es que los estratos sociodemográficos más bajos utilizan mayor cantidad de tiempo viajando, debido a las limitaciones en la movilidad a las que se encuentran sometidos.</p>
<p>Las categorías de la variable Estrato son:</p>
<ul>
<li>1 Bajo<br />
</li>
<li>2 Medio bajo<br />
</li>
<li>3 Medio alto<br />
</li>
<li>4 Alto</li>
</ul>
<p>Comenzamos por lo tanto, por calcular la duración de los viajes en minutos, a partir de las horas de inicio y término.</p>
<p><br></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(viajes2<span class="sc">$</span>p5_10_1 <span class="sc">&lt;</span> viajes2<span class="sc">$</span>p5_9_1, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                    viajes2<span class="sc">$</span>p5_10_1<span class="sc">+</span><span class="dv">24</span>, viajes2<span class="sc">$</span>p5_10_1)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>viajes2<span class="sc">$</span>duracion <span class="ot">&lt;-</span> (d1<span class="sc">-</span>viajes2<span class="sc">$</span>p5_9_1)<span class="sc">*</span><span class="dv">60</span> <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                       viajes2<span class="sc">$</span>p5_10_2<span class="sc">-</span>viajes2<span class="sc">$</span>p5_9_2</span></code></pre></div>
<p><br></p>
<p>Después, dado que se requiere categorizar a la variable continua denominada <em>duracion</em>, se procede a generar variables de rangos de minutos, según los siguientes intervalos:</p>
<ul>
<li>De 0 a 15 minutos (d0a15m)</li>
<li>De 16 a 30 minutos (d16a30m)<br />
</li>
<li>De 31 a 60 minutos (d31a60m)<br />
</li>
<li>De 61 a 90 minutos (d61a90m)<br />
</li>
<li>De 91 a 120 minutos (d91a120m)<br />
</li>
<li>Más de 120 minutos (m120m)</li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>viajes2<span class="sc">$</span>d0a15m <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(viajes2<span class="sc">$</span>duracion <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> viajes2<span class="sc">$</span>duracion <span class="sc">&lt;=</span> <span class="dv">15</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>viajes2<span class="sc">$</span>d16a30m <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(viajes2<span class="sc">$</span>duracion <span class="sc">&gt;=</span> <span class="dv">16</span> <span class="sc">&amp;</span> viajes2<span class="sc">$</span>duracion <span class="sc">&lt;=</span> <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>viajes2<span class="sc">$</span>d31a60m <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(viajes2<span class="sc">$</span>duracion <span class="sc">&gt;=</span> <span class="dv">31</span> <span class="sc">&amp;</span> viajes2<span class="sc">$</span>duracion <span class="sc">&lt;=</span> <span class="dv">60</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>viajes2<span class="sc">$</span>d61a90m <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(viajes2<span class="sc">$</span>duracion <span class="sc">&gt;=</span> <span class="dv">61</span> <span class="sc">&amp;</span> viajes2<span class="sc">$</span>duracion <span class="sc">&lt;=</span> <span class="dv">90</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>viajes2<span class="sc">$</span>d91a120m <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(viajes2<span class="sc">$</span>duracion <span class="sc">&gt;=</span> <span class="dv">91</span> <span class="sc">&amp;</span> viajes2<span class="sc">$</span>duracion <span class="sc">&lt;=</span> <span class="dv">120</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>viajes2<span class="sc">$</span>m120m <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(viajes2<span class="sc">$</span>duracion <span class="sc">&gt;=</span> <span class="dv">121</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><br></p>
<p>Y con ello se procede a generar la tabla de contingencia de las variables de interés:</p>
<p><br></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tc <span class="ot">&lt;-</span> <span class="fu">sqldf</span>(<span class="st">&quot;SELECT estrato, m120m, d91a120m, d61a90m, d31a60m, d16a30m, </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="st">        d0a15m, COUNT(*) FROM viajes2 GROUP BY estrato, m120m, d91a120m, </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="st">        d61a90m, d31a60m, d16a30m, d0a15m&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>mat_cont <span class="ot">&lt;-</span> <span class="fu">matrix</span>(tc[<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>,<span class="dv">8</span>], <span class="at">ncol=</span><span class="dv">6</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mat_cont) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bajo&quot;</span>, <span class="st">&quot;Medio bajo&quot;</span>, <span class="st">&quot;Medio alto&quot;</span>, <span class="st">&quot;Alto&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mat_cont) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;d0a15m&quot;</span>,<span class="st">&quot;d16a30m&quot;</span>,<span class="st">&quot;d31a60m&quot;</span>,<span class="st">&quot;d61a90m&quot;</span>,<span class="st">&quot;d91a120m&quot;</span>,<span class="st">&quot;m120m&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>mat_cont</span></code></pre></div>
<pre><code>##            d0a15m d16a30m d31a60m d61a90m d91a120m m120m
## Bajo         1341    1311     880     490      382   368
## Medio bajo  92422   80512   63163   32050    21081 12598
## Medio alto  47149   43047   39984   18226     9115  4749
## Alto        15211   18335   17204    6635     3455  1886</code></pre>
<p><br></p>
<p>Aplicamos la prueba <span class="math inline">\(\chi^2\)</span>, para explorar su comportamiento respecto a la independencia de las categorías:</p>
<p><br></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(mat_cont)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  mat_cont
## X-squared = 3395.3, df = 15, p-value &lt; 2.2e-16</code></pre>
<p><br></p>
<p>Donde puede verse que de acuerdo al p-valor &lt; 0.05, se rechaza la hipótesis de independencia, lo que seguramente tendrá impacto directo en la forma en que se aproximen las categorías en la proyección conjunta de los datos en el análisis de correspondencias.</p>
<p><br></p>
</div>
<div id="resultados.-1" class="section level3">
<h3>Resultados.</h3>
<p><br></p>
<p>Se aplica a continuación el análisis de correspondencias nuevamente con la librería <em>ca</em>:</p>
<p><br></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ac_datos <span class="ot">&lt;-</span> <span class="fu">ca</span>(mat_cont, <span class="at">nd =</span> <span class="dv">2</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>ac_datos</span></code></pre></div>
<pre><code>## 
##  Principal inertias (eigenvalues):
##            1        2       3    
## Value      0.005457 0.00086 7e-05
## Percentage 85.44%   13.46%  1.1% 
## 
## 
##  Rows:
##              Bajo Medio bajo Medio alto      Alto
## Mass     0.008977   0.567775   0.305252  0.117996
## ChiDist  0.239172   0.057521   0.065411  0.150958
## Inertia  0.000514   0.001879   0.001306  0.002689
## Dim. 1   2.260554   0.776101  -0.771900 -1.909552
## Dim. 2  -5.271619  -0.114956   1.073024 -1.821679
## 
## 
##  Columns:
##           d0a15m   d16a30m   d31a60m   d61a90m  d91a120m     m120m
## Mass    0.293688  0.269388  0.228052  0.107979  0.064021  0.036872
## ChiDist 0.068323  0.031349  0.104899  0.026836  0.110230  0.193895
## Inertia 0.001371  0.000265  0.002509  0.000078  0.000778  0.001386
## Dim. 1  0.808069 -0.263787 -1.418698 -0.178480  1.428388  2.308057
## Dim. 2  1.133408 -0.804079 -0.094627  0.714520 -0.952397 -3.006608</code></pre>
<p><br></p>
<p>Que nos arroja los resultados más importantes de la proyección en dos dimensiones (valores propios, varianza explicada, masa, inercia, por renglones y columnas).</p>
<p>Podemos ver, por ejemplo, que la varianza explicada por la primera coordenada es de poco más del 85%, lo cual significa que el problema de proyección en realidad es casi unidimensional, por lo que hay que darle más importancia a lo visto o representado sobre el primer eje que a lo visto sobre el segundo.</p>
<p>Los datos también contienen por supuesto las coordenadas de las dos dimensiones para renglones y columnas, las cuales pueden graficarse.</p>
<p>Tomamos en primer lugar la proyección de los renglones:</p>
<p><br></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ca</span>(ac_datos, <span class="at">what=</span><span class="fu">c</span>(<span class="st">&quot;all&quot;</span>, <span class="st">&quot;none&quot;</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span><span class="st">&quot;Proyección de los renglones en dos dimensiones&quot;</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p><br></p>
<p>Y la de las columnas:</p>
<p><br></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ca</span>(ac_datos, <span class="at">what=</span><span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;all&quot;</span>),</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span><span class="st">&quot;Proyección de las columnas en dos dimensiones&quot;</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><br></p>
<p>Para mostrar finalmente, la proyección conjunta de renglones y columnas:</p>
<p><br></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ac_datos, ,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span><span class="st">&quot;Proyección conjunta en dos dimensiones&quot;</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p><br> <br></p>
</div>
<div id="interpretación.-1" class="section level3">
<h3>Interpretación.</h3>
<p><br></p>
<p>La inercia (varianza) explicada por las dos dimensiones es de casi 99%, lo que asegura de entrada que los plots anteriores resumen muy bien la información de las correspondencias.</p>
<p>Por otra parte, de la proyección de los renglones se observa que:</p>
<ul>
<li><p>Las categorías se hallan separadas entre sí, es decir, no se aprecia cercanía alguna entre ellas.</p></li>
<li><p>Se puede observar que el orden de los puntos a lo largo de la dimensión 1, coincide con el orden de las propias categorías de <em>Alto</em> a <em>Bajo</em>, sin que se haya proporcionado al algoritmo más información que la tabla de contingencia, y sin que el resultado tenga que ver con el orden en que se colocaron las filas en dicha matriz. Lo anterior significa que el hecho de que <em>Alto</em> y <em>Bajo</em> se encuentren en los extremos de la gráfica significa que son las categorías que tienen comportamientos contrarios.</p></li>
<li><p>Finalmente, mencionar que el que unos grupos estén en la parte negativa y otros en la positiva, no tiene ningún significado, solo es interesante analizar las diferencias o similitudes existentes entre ellos.</p></li>
</ul>
<p><br></p>
<p>En cuanto a la proyección de las columnas, se observa lo siguiente:</p>
<ul>
<li><p>Se observa una buena diferenciación entre las categorías, excepto entre <em>d16a30m</em> y <em>d61a90m</em>, las cuales se encuentran cercanas en la dimensión 1 (recordemos que las distancias en esta dimensión tienen mucho mayor peso que las distancias sobre el eje vertical), lo que implica cierta semejanza en el comportamiento de ambas dentro del conjunto de datos.</p></li>
<li><p>A diferencia de la proyección por renglones, en este caso no se aprecia un ordenamiento natural de las categorías, estando en este caso <em>d31a60m</em> y <em>m120m</em> en los extremos de la proyección.</p></li>
</ul>
<p><br></p>
<p>Luego, de la proyección conjunta se observa lo siguiente:</p>
<ul>
<li><p>Siempre tomando como base las distancias sobre el eje horizontal, por ser el más relevante, se aprecia mucha cercanía entre las categorías <em>Bajo</em> y <em>m120m</em>. La siguiente categoría de duración más cercana al estrato <em>Bajo</em> es <em>d91a120m</em>. Por otra parte, cabe resaltar que el estrato más cercano a la categoría <em>d91a120m</em> es el <em>Medio Bajo</em>. Lo anterior refuerza la suposición inicial, de que los estratos sociodemográficos menos favorecidos emplean mayor tiempo en trasladarse. El estrato <em>Medio bajo</em> es muy cercano a <em>d0a15m</em>, lo que podría explicarse recordando que se captaron viajes a pie, en los cuales puede estar la mayor frecuencia de dicha duración.</p></li>
<li><p>En el centro de la gráfica se aprecia cierta cercanía entre el estrato <em>Medio alto</em> con <em>d16a30m</em> y <em>d61a90</em>, e incluso con <em>d31a60m</em>, lo que no deja muy claro el comportamiento de este estrato.</p></li>
<li><p>Por otro lado, en el extremo izquierdo de la proyección sí es posible apreciar que el estrato <em>Alto</em> tiene únicamente una categoría de duración que es la más aproximada, <em>d31a60m</em>. Esto es consistente con la hipótesis inicial, pues mientras los estratos bajos usan mucho tiempo en sus traslados, el estrato <em>Alto</em> tiende a demorarse cuando mucho una hora.</p></li>
</ul>
<p>Debemos tener presente, no obstante, que todas estas interpretaciones representan sólo un primer acercamiento a las relaciones entre estas variables con la herrmienta de análisis de correspondencias, y no consideran efectos subyacentes debido a otras causas.</p>
<p><br> <br> <br></p>
</div>
</div>
<div id="análisis-de-factores-de-variables-seleccionadas-de-la-encuesta." class="section level2">
<h2><strong>3. Análisis de Factores de variables seleccionadas de la encuesta.</strong></h2>
<p><br></p>
<div id="metodología.-2" class="section level3">
<h3>Metodología.</h3>
<p><br></p>
<p>Realización de análisis factorial para detectar variables latentes que resumen la variabilidad entre el conjunto de variables involucradas en la encuesta origen-destino de la zona metropolitana del valle de México</p>
<p>El conjunto de variables en este análisis es: - SEXO. Sexo de la persona - EDAD. Edad de la persona - ESTRATO_SOCIO. Estrato sociodemográfico de la persona - OCUPACION. Ocupación de la persona - ESTUDIOS. Grado de estudios de la persona - NUM_VIAJES. Cantidad de viajes realizados entre semana - MEDIO_TRANSPORTE. Medio de transporte que utilizó - TIEMPO_MINUTOS. Tiempo en minutos del viaje realizado (tiempo de espera y trasbordo)</p>
<p><br></p>
<p>Librerías, lectura y acondicionamiento de datos.</p>
<p><br></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Librerías</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># Prueba estadística</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats) <span class="co"># Análisis de factores</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GPArotation)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>base<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;bd/DatosAF.csv&quot;</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>base<span class="ot">&lt;-</span>base[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(base) <span class="co"># Primeras filas de los datos</span></span></code></pre></div>
<pre><code>##   ï..SEXO EDAD ESTRATO P3_7 GRA P5_4 P5_14 TIEMPO
## 1       1   29       2    1   6    2    14     10
## 2       1   29       2    1   6    2    14     10
## 3       1   29       2    1   6    2    14     10
## 4       1   29       2    1   6    2    14     10
## 5       2   28       2    1   3    4    14     20
## 6       2   28       2    1   3    4    14     20</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(base)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;SEXO&quot;</span>,<span class="st">&quot;EDAD&quot;</span>,<span class="st">&quot;ESTRATO_SOCIO&quot;</span>,<span class="st">&quot;OCUPACION&quot;</span>,<span class="st">&quot;ESTUDIOS&quot;</span>,<span class="st">&quot;NUM_VIAJES&quot;</span>,<span class="st">&quot;MEDIO_TRANSPORTE&quot;</span>,<span class="st">&quot;TIEMPO_MINUTOS&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(base) <span class="co"># Primeras filas de los datos con las columnas renombradas</span></span></code></pre></div>
<pre><code>##   SEXO EDAD ESTRATO_SOCIO OCUPACION ESTUDIOS NUM_VIAJES MEDIO_TRANSPORTE TIEMPO_MINUTOS
## 1    1   29             2         1        6          2               14             10
## 2    1   29             2         1        6          2               14             10
## 3    1   29             2         1        6          2               14             10
## 4    1   29             2         1        6          2               14             10
## 5    2   28             2         1        3          4               14             20
## 6    2   28             2         1        3          4               14             20</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se categorizan los 99&#39;s en NA</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>base[base<span class="sc">==</span><span class="dv">99</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(base)</span></code></pre></div>
<pre><code>##       SEXO            EDAD      ESTRATO_SOCIO     OCUPACION        ESTUDIOS       NUM_VIAJES   
##  Min.   :1.000   Min.   : 6.0   Min.   :1.000   Min.   :1.00    Min.   :0.000   Min.   : 1.00  
##  1st Qu.:1.000   1st Qu.:23.0   1st Qu.:2.000   1st Qu.:1.00    1st Qu.:3.000   1st Qu.: 2.00  
##  Median :1.000   Median :35.0   Median :2.000   Median :1.00    Median :3.000   Median : 2.00  
##  Mean   :1.498   Mean   :36.6   Mean   :2.504   Mean   :2.48    Mean   :3.242   Mean   : 2.33  
##  3rd Qu.:2.000   3rd Qu.:49.0   3rd Qu.:3.000   3rd Qu.:4.00    3rd Qu.:4.000   3rd Qu.: 2.00  
##  Max.   :2.000   Max.   :97.0   Max.   :4.000   Max.   :8.00    Max.   :9.000   Max.   :14.00  
##                                                 NA&#39;s   :50698                   NA&#39;s   :32947  
##  MEDIO_TRANSPORTE TIEMPO_MINUTOS   
##  Min.   : 1.00    Min.   :   1.00  
##  1st Qu.: 2.00    1st Qu.:  10.00  
##  Median : 7.00    Median :  15.00  
##  Mean   : 8.07    Mean   :  24.88  
##  3rd Qu.:14.00    3rd Qu.:  30.00  
##  Max.   :20.00    Max.   :1200.00  
##                   NA&#39;s   :9917</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>baseLW<span class="ot">&lt;-</span><span class="fu">na.omit</span>(base) <span class="co"># Se omiten los NA&#39;s</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(baseLW)</span></code></pre></div>
<pre><code>##   SEXO EDAD ESTRATO_SOCIO OCUPACION ESTUDIOS NUM_VIAJES MEDIO_TRANSPORTE TIEMPO_MINUTOS
## 1    1   29             2         1        6          2               14             10
## 2    1   29             2         1        6          2               14             10
## 3    1   29             2         1        6          2               14             10
## 4    1   29             2         1        6          2               14             10
## 5    2   28             2         1        3          4               14             20
## 6    2   28             2         1        3          4               14             20</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mat_base<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(baseLW) </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>idx<span class="ot">&lt;-</span><span class="fu">complete.cases</span>(baseLW) <span class="co"># Se obtiene el vector lógico de casos completos</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">#idx</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>datos_compl<span class="ot">&lt;-</span>mat_base[idx,] <span class="co"># Datos completos</span></span></code></pre></div>
<p><br></p>
<p>Se obtiene la matriz de correlaciones:</p>
<p><br></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">dim</span>(datos_compl)[<span class="dv">1</span>]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">dim</span>(datos_compl)[<span class="dv">2</span>]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datos_compl)</span></code></pre></div>
<pre><code>## [1] 798517      8</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mat_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(datos_compl),<span class="dv">3</span>) <span class="co"># Se obtiene la matriz de correlación</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>mat_cor</span></code></pre></div>
<pre><code>##                    SEXO   EDAD ESTRATO_SOCIO OCUPACION ESTUDIOS NUM_VIAJES MEDIO_TRANSPORTE
## SEXO              1.000  0.014         0.016     0.252    0.010      0.154            0.085
## EDAD              0.014  1.000         0.086     0.000    0.232      0.034           -0.024
## ESTRATO_SOCIO     0.016  0.086         1.000     0.002    0.026      0.037           -0.087
## OCUPACION         0.252  0.000         0.002     1.000   -0.074      0.139            0.115
## ESTUDIOS          0.010  0.232         0.026    -0.074    1.000     -0.001           -0.013
## NUM_VIAJES        0.154  0.034         0.037     0.139   -0.001      1.000            0.055
## MEDIO_TRANSPORTE  0.085 -0.024        -0.087     0.115   -0.013      0.055            1.000
## TIEMPO_MINUTOS   -0.087  0.028         0.031    -0.093    0.024     -0.088           -0.479
##                  TIEMPO_MINUTOS
## SEXO                     -0.087
## EDAD                      0.028
## ESTRATO_SOCIO             0.031
## OCUPACION                -0.093
## ESTUDIOS                  0.024
## NUM_VIAJES               -0.088
## MEDIO_TRANSPORTE         -0.479
## TIEMPO_MINUTOS            1.000</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se grafica la matriz de correlación</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(mat_cor,<span class="at">type=</span><span class="st">&quot;lower&quot;</span>,<span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">tl.cex =</span> <span class="dv">10</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">ggtheme =</span> ggplot2<span class="sc">::</span>theme_gray,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;deeppink&quot;</span>))</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se calcula el determinante:</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(mat_cor)</span></code></pre></div>
<pre><code>## [1] 0.6264238</code></pre>
<p><br></p>
<p>COMENTARIOS: Los resultados obtenidos tanto de la matriz de correlación como del determinante, indican que existe bajo nivel de colinealidad.</p>
<p>Se aplica la prueba de Bartlett que se utiliza para probar la hipótesis nula que afirma que las variables no están correlacionadas en la población o el supuesto de homogeneidad de varianzas:</p>
<p><br></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>p_fac<span class="ot">&lt;-</span><span class="fu">cortest.bartlett</span>(mat_cor,<span class="at">n=</span><span class="fu">nrow</span>(baseLW))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>p_fac</span></code></pre></div>
<pre><code>## $chisq
## [1] 373486.7
## 
## $p.value
## [1] 0
## 
## $df
## [1] 28</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>p_fac<span class="sc">$</span>p</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p><br></p>
<p>De acuerdo a los resultados obtenidos se podría interpretar la presencia de multicolinealidad en el conjunto de variables, ya que el p-valor es menor a 0.05.</p>
<p>Se aplica otra prueba de Kaiser-Meyer-Olkin en donde los resultados son valorados como:</p>
<ul>
<li>0.00 a 0.49 inaceptable.<br />
</li>
<li>0.50 a 0.59 escasamente regular.<br />
</li>
<li>0,60 a 0,69 regular.<br />
</li>
<li>0.70 a 0.79 medio.<br />
</li>
<li>0,80 a 0,89 meritorio.<br />
</li>
<li>0.90 a 1.00 maravilloso.</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(mat_cor)</span></code></pre></div>
<pre><code>## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = mat_cor)
## Overall MSA =  0.55
## MSA for each item = 
##             SEXO             EDAD    ESTRATO_SOCIO        OCUPACION         ESTUDIOS 
##             0.59             0.51             0.55             0.60             0.50 
##       NUM_VIAJES MEDIO_TRANSPORTE   TIEMPO_MINUTOS 
##             0.65             0.53             0.53</code></pre>
<p><br></p>
<p>De acuerdo a los resultados de la prueba KMO, se observa que existe un bajo nivel de multicolinealidad entre las variables.</p>
<p><br></p>
</div>
<div id="resultados.-2" class="section level3">
<h3>Resultados.</h3>
<p><br></p>
<p>Se aplica el análisis de factores.</p>
<p><br></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># minres --&gt; modelo mínimo residuo</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Se determina el número de factores</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(mat_cor)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(mat_cor,<span class="at">n.obs=</span><span class="fu">nrow</span>(datos_compl),<span class="at">fa=</span><span class="st">&quot;fa&quot;</span>,<span class="at">fm=</span><span class="st">&quot;minres&quot;</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<pre><code>## Parallel analysis suggests that the number of factors =  4  and the number of components =  NA</code></pre>
<p><br></p>
<p>COMENTARIOS: De acuerdo a los resultados gráficos se observa que a partir de 2 factores se pueden utilizar, sin embargo con 4 factores se podría considerar para un patrón ideal.</p>
<p>De acuerdo a estos resultados se considerarán 4 factores.</p>
<p><br></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Se ejecutan las Rotaciones</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>datos.fa.none <span class="ot">&lt;-</span> <span class="fu">factanal</span>(datos_compl, <span class="at">factors =</span> <span class="dv">4</span>, <span class="at">rotation =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>datos.fa.varimax <span class="ot">&lt;-</span> <span class="fu">factanal</span>(datos_compl, <span class="at">factors =</span> <span class="dv">4</span>, <span class="at">rotation =</span> <span class="st">&quot;varimax&quot;</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>datos.fa.promax <span class="ot">&lt;-</span> <span class="fu">factanal</span>(datos_compl, <span class="at">factors =</span> <span class="dv">4</span>, <span class="at">rotation =</span> <span class="st">&quot;promax&quot;</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datos.fa.none<span class="sc">$</span>loadings,<span class="at">pch=</span><span class="dv">21</span>,            </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg=</span><span class="st">&quot;orange&quot;</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;No rotación&quot;</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datos.fa.varimax<span class="sc">$</span>loadings,<span class="at">pch=</span><span class="dv">21</span>,            </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg=</span><span class="st">&quot;magenta&quot;</span>,</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Rotación Varimax&quot;</span>)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(datos.fa.varimax<span class="sc">$</span>loadings<span class="fl">-0.08</span>,</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>     <span class="fu">colnames</span>(baseLW),</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datos.fa.promax<span class="sc">$</span>loadings,<span class="at">pch=</span><span class="dv">21</span>,            </span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg=</span><span class="st">&quot;cyan&quot;</span>, </span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Rotación Promax&quot;</span>)</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>modeloAF<span class="ot">&lt;-</span><span class="fu">fa</span>(datos_compl,<span class="at">rotate =</span> <span class="st">&quot;varimax&quot;</span>,<span class="at">nfactors =</span> <span class="dv">4</span>,<span class="at">fm=</span><span class="st">&quot;minres&quot;</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modeloAF)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-19-2.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.diagram</span>(modeloAF)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-19-3.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>modeloAF<span class="sc">$</span>uniquenesses</span></code></pre></div>
<pre><code>##             SEXO             EDAD    ESTRATO_SOCIO        OCUPACION         ESTUDIOS 
##      0.741177481      0.916473638      0.782468240      0.746111214      0.004914492 
##       NUM_VIAJES MEDIO_TRANSPORTE   TIEMPO_MINUTOS 
##      0.907461997      0.732643871      0.004810233</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>modeloAF<span class="sc">$</span>communalities</span></code></pre></div>
<pre><code>##             SEXO             EDAD    ESTRATO_SOCIO        OCUPACION         ESTUDIOS 
##       0.25882590       0.08352524       0.21753080       0.25388607       0.99500000 
##       NUM_VIAJES MEDIO_TRANSPORTE   TIEMPO_MINUTOS 
##       0.09253561       0.26735476       0.99500000</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>modeloAF_re<span class="ot">&lt;-</span><span class="fu">factanal</span>(datos_compl,<span class="at">factors=</span><span class="dv">4</span>,<span class="at">rotation =</span> <span class="st">&quot;varimax&quot;</span>,<span class="at">scores=</span><span class="st">&quot;regression&quot;</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>modeloAF_re</span></code></pre></div>
<pre><code>## 
## Call:
## factanal(x = datos_compl, factors = 4, scores = &quot;regression&quot;,     rotation = &quot;varimax&quot;)
## 
## Uniquenesses:
##             SEXO             EDAD    ESTRATO_SOCIO        OCUPACION         ESTUDIOS 
##            0.747            0.918            0.775            0.740            0.005 
##       NUM_VIAJES MEDIO_TRANSPORTE   TIEMPO_MINUTOS 
##            0.908            0.733            0.005 
## 
## Loadings:
##                  Factor1 Factor2 Factor3 Factor4
## SEXO                              0.499         
## EDAD                      0.245           0.143 
## ESTRATO_SOCIO                             0.466 
## OCUPACION                         0.504         
## ESTUDIOS                  0.994                 
## NUM_VIAJES                        0.287         
## MEDIO_TRANSPORTE -0.477           0.144  -0.136 
## TIEMPO_MINUTOS    0.993                         
## 
##                Factor1 Factor2 Factor3 Factor4
## SS loadings      1.227   1.056   0.617   0.269
## Proportion Var   0.153   0.132   0.077   0.034
## Cumulative Var   0.153   0.285   0.363   0.396
## 
## Test of the hypothesis that 4 factors are sufficient.
## The chi square statistic is 921.45 on 2 degrees of freedom.
## The p-value is 8.11e-201</code></pre>
<p><br></p>
<p>COMENTARIOS: Derivado de estos resultados, se observa que el factor 1 explica el 15% de la varianza, el factor 2 explica el 13%, el factor 3 explica el 7% y el factor 4 explica el 3%.</p>
<p><br></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diagram</span>(modeloAF_re)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Se obtienen los scores</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>scoresAF<span class="ot">&lt;-</span>modeloAF_re<span class="sc">$</span>scores</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(scoresAF)</span></code></pre></div>
<pre><code>##     Factor1           Factor2           Factor3            Factor4       
##  Min.   :-1.2079   Min.   :-2.4770   Min.   :-1.14256   Min.   :-7.1424  
##  1st Qu.:-0.6547   1st Qu.:-0.2521   1st Qu.:-0.64700   1st Qu.:-0.3956  
##  Median :-0.3010   Median :-0.1880   Median :-0.03189   Median :-0.1279  
##  Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  
##  3rd Qu.: 0.2752   3rd Qu.: 0.5173   3rd Qu.: 0.51193   3rd Qu.: 0.3462  
##  Max.   :49.5011   Max.   : 4.3248   Max.   : 3.00162   Max.   : 2.0227</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Se obtienen los loadings</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>loadingsAF<span class="ot">&lt;-</span>modeloAF<span class="sc">$</span>loadings</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(loadingsAF)</span></code></pre></div>
<pre><code>##       MR1                MR2                MR3                MR4          
##  Min.   :-0.47727   Min.   :-0.04957   Min.   :-0.07618   Min.   :-0.13725  
##  1st Qu.:-0.06030   1st Qu.: 0.01111   1st Qu.: 0.01199   1st Qu.:-0.05000  
##  Median :-0.02717   Median : 0.02992   Median : 0.08938   Median :-0.01525  
##  Mean   : 0.05283   Mean   : 0.16342   Mean   : 0.17173   Mean   : 0.05109  
##  3rd Qu.: 0.03393   3rd Qu.: 0.10233   3rd Qu.: 0.34005   3rd Qu.: 0.09328  
##  Max.   : 0.99323   Max.   : 0.99441   Max.   : 0.50547   Max.   : 0.45839</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(loadingsAF,<span class="at">pch=</span><span class="dv">21</span>,            </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg=</span><span class="st">&quot;purple&quot;</span>,         </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex=</span><span class="dv">1</span>,) <span class="co"># Dibujar el área de visualización</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(loadingsAF,<span class="at">labels=</span><span class="fu">names</span>(baseLW),<span class="at">cex=</span>.<span class="dv">7</span>) <span class="co"># Añadir las variables</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>,<span class="at">col =</span> <span class="st">&quot;cornflowerblue&quot;</span>,<span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p><br> <br> <br></p>
</div>
</div>
<div id="análisis-de-correspondencias-entre-las-variables-estrato-sociodemográfico-vs-tipo-de-transporte-p5_14." class="section level2">
<h2><strong>4. Análisis de Correspondencias entre las variables: Estrato sociodemográfico vs Tipo de Transporte (P5_14).</strong></h2>
<p><br></p>
<div id="metodología.-3" class="section level3">
<h3>Metodología.</h3>
<p><br></p>
<p>El propósito del análisis de correspondencia entre estrato socioecónomico y el tipo de transporte de la Encuesta Origen destino 2017, es observar entre los diferentes estratos que transporte se usa más comúnmente en la movilidad urbana.</p>
<p>Se considera importante esta correspondencia ya que en la CDMX y áreas conurbadas en la encuesta se clasifican 20 tipos de transporte: “Automovil”, “Colectivo”, “Taxi_I”, “Taxi_S,”, “Metro”, “Autobus_RTP”, “Bicicleta”, “Autobus”, “Moto”, “Trolebus”, “Metrobus”, “Tren_L”, “Tren_S”, “Caminar”, “Mexicable”, “Bicitaxi”, “Mototaxi”, “T.Escolar”, “T.Personal”, “otro”.</p>
<p>En lo referente a la variable de estrato se clasifican 4 estratos sociodemográficos: “Bajo”, “Medio Bajo”, “Medio Alto” y “Alto”.</p>
<p>Primero, invocamos librerías y leemos los datos.</p>
<p><br></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;stats&quot;</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;scatterplot3d&quot;</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;smacof&quot;</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>datosC <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bd/ttransporte2.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datosC)</span></code></pre></div>
<pre><code>##   p5_14 estrato
## 1    14       3
## 2     2       3
## 3     5       3
## 4    14       3
## 5    14       3
## 6     2       3</code></pre>
<p><br></p>
<p>Se calcula la tabla de contingencia entre la variable de estrato y tipo de transporte.</p>
<p><br></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>tabla_T<span class="ot">&lt;-</span><span class="fu">table</span>(datosC<span class="sc">$</span>estrato,datosC<span class="sc">$</span>p5_14)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>tabla_T</span></code></pre></div>
<pre><code>##    
##          1      2      3      4      5      6      7      8      9     10     11     12     13
##   1    434   2526      6    129    516     16    140    103     61      1     91      5      0
##   2  42518 143108    731  13449  36099   3577   8917   9440   3894    682   7060    913   1036
##   3  38106  59091   1167   9596  25006   2147   2334   3754   1364   1050   7191    533   1031
##   4  31278  15758    864   2980   5845    468    563   1181    433    269   1843    146    487
##    
##         14     15     16     17     18     19     20
##   1   4156      0     12     35      8      4     30
##   2 237893    129   1016   3537   1224    317    503
##   3 120897      0    391    751    664    137    181
##   4  27884      0    129     88    719     77     29</code></pre>
<p><br></p>
<p>Se calcula la <span class="math inline">\(\chi^2\)</span> para probar la independencia de los renglones y columnas de la tabla de contingencia y la inercia total (medida de la variabilidad total de los datos en la tabla).</p>
<p><br></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">sum</span>(tabla_T)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>n</span></code></pre></div>
<pre><code>## [1] 890748</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>chiR<span class="ot">&lt;-</span><span class="fu">chisq.test</span>(tabla_T,<span class="at">simulate.p.value=</span>T) <span class="co"># Se tuvo que usar esta alternativa debido al </span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="co"># warning : Chi-squared approximation may be incorrect</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>chiR</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with simulated p-value (based on 2000 replicates)
## 
## data:  tabla_T
## X-squared = 62446, df = NA, p-value = 0.0004998</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>inetot<span class="ot">&lt;-</span>chiR<span class="sc">$</span>statistic<span class="sc">/</span>n</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>inetot</span></code></pre></div>
<pre><code>##  X-squared 
## 0.07010537</code></pre>
<p><br></p>
<p>Tenemos que el valor p es muy pequeño, por lo tanto se rechaza la hipótesis de independencia.</p>
<p>Se calcula la matriz F de frecuencias relativas o matriz de correspondencia.</p>
<p><br></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>nrow<span class="ot">&lt;-</span><span class="fu">nrow</span>(tabla_T)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>ncol<span class="ot">&lt;-</span><span class="fu">ncol</span>(tabla_T)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>F_Esp_V<span class="ot">&lt;-</span>(tabla_T)<span class="sc">/</span>n</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>F_Esp_V</span></code></pre></div>
<pre><code>##    
##                1            2            3            4            5            6            7
##   1 4.872310e-04 2.835819e-03 6.735912e-06 1.448221e-04 5.792884e-04 1.796243e-05 1.571713e-04
##   2 4.773292e-02 1.606605e-01 8.206586e-04 1.509855e-02 4.052661e-02 4.015726e-03 1.001069e-02
##   3 4.277978e-02 6.633863e-02 1.310135e-03 1.077297e-02 2.807304e-02 2.410334e-03 2.620270e-03
##   4 3.511431e-02 1.769075e-02 9.699713e-04 3.345503e-03 6.561901e-03 5.254011e-04 6.320531e-04
##    
##                8            9           10           11           12           13           14
##   1 1.156332e-04 6.848177e-05 1.122652e-06 1.021613e-04 5.613260e-06 0.000000e+00 4.665742e-03
##   2 1.059783e-02 4.371607e-03 7.656486e-04 7.925923e-03 1.024981e-03 1.163067e-03 2.670710e-01
##   3 4.214436e-03 1.531297e-03 1.178785e-03 8.072990e-03 5.983735e-04 1.157454e-03 1.357253e-01
##   4 1.325852e-03 4.861083e-04 3.019934e-04 2.069048e-03 1.639072e-04 5.467315e-04 3.130403e-02
##    
##               15           16           17           18           19           20
##   1 0.000000e+00 1.347182e-05 3.929282e-05 8.981216e-06 4.490608e-06 3.367956e-05
##   2 1.448221e-04 1.140614e-03 3.970820e-03 1.374126e-03 3.558807e-04 5.646939e-04
##   3 0.000000e+00 4.389569e-04 8.431116e-04 7.454409e-04 1.538033e-04 2.032000e-04
##   4 0.000000e+00 1.448221e-04 9.879337e-05 8.071868e-04 8.644420e-05 3.255691e-05</code></pre>
<p><br></p>
<p>Se calculan las frecuencias relativas de las filas y de las columnas de F o tambien llamadas masas (las ri y las cj).</p>
<p><br></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>rtot<span class="ot">&lt;-</span><span class="fu">apply</span>(F_Esp_V,<span class="dv">1</span>,sum)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>ctot<span class="ot">&lt;-</span><span class="fu">apply</span>(F_Esp_V,<span class="dv">2</span>,sum)</span></code></pre></div>
<p><br></p>
<p>Los vectores obtenidos se colocan en las matrices diagonales correspondientes (Dr y Dc).</p>
<p><br></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>Dr<span class="ot">&lt;-</span><span class="fu">diag</span>(rtot)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Dr)</span></code></pre></div>
<pre><code>##  num [1:4, 1:4] 0.00929 0 0 0 0 ...</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>Dc<span class="ot">&lt;-</span><span class="fu">diag</span>(ctot)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Dc)</span></code></pre></div>
<pre><code>##  num [1:20, 1:20] 0.126 0 0 0 0 ...</code></pre>
<p><br></p>
<p>Se calcula la matriz de perfiles por fila (R).</p>
<p><br></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>table.pro<span class="ot">&lt;-</span>F_Esp_V<span class="sc">/</span>rtot  <span class="co">#matriz R de renglones</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>table.pro</span></code></pre></div>
<pre><code>##    
##                1            2            3            4            5            6            7
##   1 0.0524598090 0.3053305935 0.0007252508 0.0155928925 0.0623715702 0.0019340022 0.0169225190
##   2 0.0823923588 0.2773179754 0.0014165486 0.0260617817 0.0699534729 0.0069315929 0.0172795678
##   3 0.1383705350 0.2145712823 0.0042376113 0.0348450022 0.0908018054 0.0077961880 0.0084752225
##   4 0.3435594952 0.1730868510 0.0094902297 0.0327325051 0.0642018431 0.0051405411 0.0061840270
##    
##                8            9           10           11           12           13           14
##   1 0.0124501390 0.0073733833 0.0001208751 0.0109996374 0.0006043757 0.0000000000 0.5023570652
##   2 0.0182930492 0.0075458828 0.0013215953 0.0136810305 0.0017692324 0.0020075846 0.4609945295
##   3 0.0136315275 0.0049529578 0.0038127608 0.0261119644 0.0019354300 0.0037437680 0.4390012746
##   4 0.0129721774 0.0047560989 0.0029547127 0.0202436265 0.0016036731 0.0053492383 0.3062795883
##    
##               15           16           17           18           19           20
##   1 0.0000000000 0.0014505016 0.0042306298 0.0009670011 0.0004835005 0.0036262541
##   2 0.0002499792 0.0019688282 0.0068540800 0.0023718954 0.0006142899 0.0009747250
##   3 0.0000000000 0.0014197995 0.0027270317 0.0024111173 0.0004974745 0.0006572473
##   4 0.0000000000 0.0014169440 0.0009665975 0.0078975407 0.0008457728 0.0003185378</code></pre>
<p><br></p>
<p>Se calcula la matriz de perfiles por columna (Rc).</p>
<p><br></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>table.pcol<span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(F_Esp_V)<span class="sc">/</span>ctot)  <span class="co">#matriz R de columnas</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>table.pcol</span></code></pre></div>
<pre><code>##    
##                1            2            3            4            5            6            7
##   1 0.0038634098 0.0114566656 0.0021676301 0.0049323239 0.0076482969 0.0025773196 0.0117115610
##   2 0.3784895314 0.6490659144 0.2640895954 0.5142234457 0.5350695165 0.5761920103 0.7459427807
##   3 0.3392144994 0.2680070572 0.4216040462 0.3669037241 0.3706459550 0.3458440722 0.1952484524
##   4 0.2784325595 0.0714703628 0.3121387283 0.1139405062 0.0866362316 0.0753865979 0.0470972060
##    
##                8            9           10           11           12           13           14
##   1 0.0071142423 0.0106050070 0.0004995005 0.0056224900 0.0031308704 0.0000000000 0.0106337794
##   2 0.6520237602 0.6769819193 0.3406593407 0.4362063639 0.5716969317 0.4056382146 0.6086866413
##   3 0.2592899572 0.2371349096 0.5244755245 0.4443002780 0.3337507827 0.4036805012 0.3093339815
##   4 0.0815720403 0.0752781641 0.1343656344 0.1138708681 0.0914214152 0.1906812843 0.0713455978
##    
##               15           16           17           18           19           20
##   1 0.0000000000 0.0077519380 0.0079347087 0.0030592734 0.0074766355 0.0403768506
##   2 1.0000000000 0.6563307494 0.8018589889 0.4680688337 0.5925233645 0.6769851952
##   3 0.0000000000 0.2525839793 0.1702561777 0.2539196941 0.2560747664 0.2436069987
##   4 0.0000000000 0.0833333333 0.0199501247 0.2749521989 0.1439252336 0.0390309556</code></pre>
<p><br></p>
<p>Se calcula la <span class="math inline">\(\chi^2\)</span> para verificar la independencia de los renglones y columnas de la tabla de contingencia y la inercia total (medida de la variabilidad total de los datos en la tabla)</p>
<p><br></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>t.rowsum<span class="ot">&lt;-</span>n<span class="sc">*</span>rtot <span class="co">#suma de las entradas por fila de la tabla de contingencia</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>t.colsum<span class="ot">&lt;-</span>n<span class="sc">*</span>ctot <span class="co">#suma de las entradas por columna de la tabla de contingencia  </span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>tabla_exp<span class="ot">&lt;-</span>t.rowsum<span class="sc">%o%</span>t.colsum<span class="sc">/</span>n  <span class="co"># matriz de frecuencias esperadas</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>tabla_exp</span></code></pre></div>
<pre><code>##           1         2          3          4         5          6         7         8          9
## 1  1043.343   2047.78   25.70835   242.9105   626.604   57.65804  111.0252  134.4673   53.42285
## 2 65080.367 127733.89 1603.60396 15151.9719 39085.529 3596.52219 6925.3908 8387.6366 3332.34465
## 3 34730.724  68166.34  855.77771  8085.9864 20858.345 1919.31649 3695.7973 4476.1379 1778.33577
## 4 11481.566  22534.98  282.90997  2673.1312  6895.522  634.50328 1221.7868 1479.7581  587.89672
##           10        11        12         13         14        15        16         17         18
## 1   18.59397  150.3214  14.83246   23.72079   3629.912  1.198113  14.37736   40.96804   24.28733
## 2 1159.83206 9376.5644 925.20070 1479.62591 226422.159 74.734433 896.81320 2555.45415 1514.96545
## 3  618.95484 5003.8881 493.74169  789.61571 120832.227 39.882704 478.59245 1363.74115  808.47497
## 4  204.61913 1654.2261 163.22515  261.03759  39945.702 13.184749 158.21699  450.83666  267.27224
##           19         20
## 1   4.968919   6.900761
## 2 309.945130 430.447162
## 3 165.405014 229.712009
## 4  54.680937  75.940067</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>chi2<span class="ot">&lt;-</span> <span class="fu">sum</span>((tabla_T<span class="sc">-</span>tabla_exp)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>tabla_exp)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>chi2</span></code></pre></div>
<pre><code>## [1] 62446.22</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>inetot1<span class="ot">&lt;-</span>chi2<span class="sc">/</span>n</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>inetot1</span></code></pre></div>
<pre><code>## [1] 0.07010537</code></pre>
<p><br></p>
<p>Se calcula la matriz <span class="math inline">\(Z\)</span>.</p>
<p><br></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>(<span class="fu">sqrt</span>(<span class="fu">solve</span>(Dr)))<span class="sc">%*%</span>F_Esp_V<span class="sc">%*%</span>(<span class="fu">sqrt</span>(<span class="fu">solve</span>(Dc)))</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>Z</span></code></pre></div>
<pre><code>##            [,1]       [,2]        [,3]        [,4]       [,5]        [,6]       [,7]        [,8]
## [1,] 0.01423635 0.05914449 0.001253824 0.008769789 0.02184116 0.002232609 0.01407797 0.009411339
## [2,] 0.17659175 0.42426129 0.019341555 0.115765190 0.19346827 0.063197535 0.11353224 0.109213107
## [3,] 0.21665016 0.23980538 0.042268121 0.113069718 0.18345387 0.051925576 0.04067891 0.059451814
## [4,] 0.30928652 0.11122311 0.054426723 0.061070109 0.07458020 0.019685728 0.01706606 0.032529479
##             [,9]        [,10]       [,11]       [,12]      [,13]      [,14]      [,15]       [,16]
## [1,] 0.008842781 0.0002457177 0.007864182 0.001375581 0.00000000 0.07308867 0.00000000 0.003353237
## [2,] 0.071473255 0.0212182417 0.077251230 0.031803533 0.02853687 0.52971805 0.01581073 0.035947218
## [3,] 0.034271259 0.0447180020 0.107710506 0.025415571 0.03887526 0.36850782 0.00000000 0.018937228
## [4,] 0.018921691 0.0199251562 0.048012075 0.012108264 0.03193743 0.14782321 0.00000000 0.010866401
##            [,17]       [,18]       [,19]       [,20]
## [1,] 0.005793860 0.001719977 0.001901304 0.012100278
## [2,] 0.074135050 0.033319818 0.019078289 0.025688020
## [3,] 0.021547482 0.024743285 0.011286747 0.012653460
## [4,] 0.004391326 0.046598779 0.011033043 0.003526023</code></pre>
<p><br></p>
<p>Se obtienen los vectores propios y valores propios mediante la descomposicion en valores singulares de <span class="math inline">\(Z\)</span>.</p>
<p><br></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>dvalsing<span class="ot">&lt;-</span><span class="fu">svd</span>(Z)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>dvalsing</span></code></pre></div>
<pre><code>## $d
## [1] 1.00000000 0.25209233 0.07953279 0.01514474
## 
## $u
##             [,1]       [,2]        [,3]        [,4]
## [1,] -0.09637271 -0.1028915  0.08540593 -0.98632219
## [2,] -0.76114170 -0.4670377  0.42081978  0.15953003
## [3,] -0.55602900  0.1607302 -0.81480615 -0.03299229
## [4,] -0.31969886  0.8633973  0.38949644 -0.02510407
## 
## $v
##              [,1]         [,2]        [,3]        [,4]
##  [1,] -0.35512566  0.864443516  0.24477053 -0.05164041
##  [2,] -0.49751952 -0.276318507  0.39625097 -0.08960112
##  [3,] -0.05574496  0.177012164 -0.06280324 -0.06021698
##  [4,] -0.17135297  0.063200831 -0.23736171  0.30074133
##  [5,] -0.27521053  0.005056392 -0.46710271  0.09222657
##  [6,] -0.08348307 -0.017464766 -0.09878073  0.37455231
##  [7,] -0.11584551 -0.131694669  0.28265943  0.16216015
##  [8,] -0.12749022 -0.056857805  0.13819749  0.35405583
##  [9,] -0.08035854 -0.049367574  0.12923078  0.07095535
## [10,] -0.04740832  0.057343511 -0.24801953  0.07705896
## [11,] -0.13479660  0.086783423 -0.45116182 -0.01265394
## [12,] -0.04234236 -0.001807636 -0.03132795  0.16998432
## [13,] -0.05354674  0.081300883 -0.09087331  0.16297039
## [14,] -0.66239420 -0.269972507 -0.17009068 -0.22792900
## [15,] -0.01203421 -0.029291675  0.08365692  0.16654536
## [16,] -0.04168771 -0.018675376  0.05300884  0.10100637
## [17,] -0.07037058 -0.110932416  0.19923494  0.34936308
## [18,] -0.05418242  0.112941449  0.15286289  0.10781983
## [19,] -0.02450753  0.008862282  0.04138826  0.03426349
## [20,] -0.02888132 -0.032385506  0.03654743 -0.55086753</code></pre>
<p><br></p>
<p>Se obtienen las representaciones de las filas y columnas en un espacio de tres dimensiones considerando los vectores propios obtenidos de la dvs.</p>
<p>Se consideran solo los vectores propios asociados a valores propios distintos de 1, en este caso se consideran las columnas 2,3 y 4 de las matrices <span class="math inline">\(U\)</span> y <span class="math inline">\(V\)</span> de la dvs.</p>
<p><br></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>ind<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span></code></pre></div>
<p><br></p>
<p>Representacion de las filas en tres dimensiones.</p>
<p><br></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>Cr<span class="ot">&lt;-</span>(<span class="fu">sqrt</span>(<span class="fu">solve</span>(Dr)))<span class="sc">%*%</span>Z<span class="sc">%*%</span>dvalsing<span class="sc">$</span>v[,ind]</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>Cr</span></code></pre></div>
<pre><code>##             [,1]        [,2]          [,3]
## [1,] -0.26914425  0.07048232 -0.1549981648
## [2,] -0.15468422  0.04397206  0.0031742328
## [3,]  0.07287182 -0.11654753 -0.0008986216
## [4,]  0.68081520  0.09689662 -0.0011892276</code></pre>
<p><br></p>
<p>Representación de las columnas en tres dimensiones.</p>
<p><br></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>Cc<span class="ot">&lt;-</span>(<span class="fu">sqrt</span>(<span class="fu">solve</span>(Dc)))<span class="sc">%*%</span><span class="fu">t</span>(Z)<span class="sc">%*%</span>dvalsing<span class="sc">$</span>u[,ind]</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>Cc</span></code></pre></div>
<pre><code>##               [,1]        [,2]         [,3]
##  [1,]  0.613640754  0.05481801 -0.002202265
##  [2,] -0.140010134  0.06334414 -0.002727503
##  [3,]  0.800492231 -0.08960302 -0.016359696
##  [4,]  0.092980265 -0.11017048  0.026580510
##  [5,]  0.004631646 -0.13498750  0.005075196
##  [6,] -0.052738037 -0.09410658  0.067947877
##  [7,] -0.286581809  0.19405752  0.021199556
##  [8,] -0.112427577  0.08621236  0.042058786
##  [9,] -0.154870750  0.12790283  0.013372573
## [10,]  0.304922378 -0.41608060  0.024616731
## [11,]  0.162299610 -0.26619483 -0.001421703
## [12,] -0.010762067 -0.05884414  0.060798891
## [13,]  0.382755877 -0.13497382  0.046093271
## [14,] -0.102745461 -0.02042256 -0.005211286
## [15,] -0.613601480  0.55287968  0.209593077
## [16,] -0.112933016  0.10113151  0.036694632
## [17,] -0.397399207  0.22517522  0.075187863
## [18,]  0.525478028  0.22438296  0.030137142
## [19,]  0.091160300  0.13431482  0.021173562
## [20,] -0.282678864  0.10064357 -0.288863079</code></pre>
<p><br></p>
<p>Se calcula la proporción de la inercia explicada por las dos dimensiones (asociadas a valores propios mas grandes distintos de uno).</p>
<p><br></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>vp<span class="ot">&lt;-</span>(dvalsing<span class="sc">$</span>d)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>vp_dist1<span class="ot">&lt;-</span>vp[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>vp_dist1</span></code></pre></div>
<pre><code>## [1] 0.0635505404 0.0063254643 0.0002293632</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>var_expl <span class="ot">&lt;-</span> <span class="fu">sum</span>(vp_dist1[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])<span class="sc">/</span><span class="fu">sum</span>(vp_dist1)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>var_expl</span></code></pre></div>
<pre><code>## [1] 0.9967283</code></pre>
<p><br></p>
<p>Se observa una varianza explicada alta cercana a 1.</p>
<p><br></p>
</div>
<div id="resultados.-3" class="section level3">
<h3>Resultados.</h3>
<p><br></p>
<p>Se obtiene la representacion conjunta de los renglones y columnas en el espacio de dos dimensiones:</p>
<p><br></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Cr,<span class="at">xlim=</span><span class="fu">range</span>(Cr[,<span class="dv">1</span>],Cc[,<span class="dv">1</span>]),<span class="at">ylim=</span><span class="fu">range</span>(Cr[,<span class="dv">1</span>],Cc[,<span class="dv">1</span>]),</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Coordenada 1&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Coordenada 2&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Cc,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(Cr,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Bajo&quot;</span>,<span class="st">&quot;Medio Bajo&quot;</span>,<span class="st">&quot;Medio Alto&quot;</span>,<span class="st">&quot;Alto&quot;</span>),<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(Cc,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Automovil&quot;</span>,<span class="st">&quot;Colectivo&quot;</span>,<span class="st">&quot;Taxi_I&quot;</span>,<span class="st">&quot;Taxi_S,&quot;</span>,<span class="st">&quot;Metro&quot;</span>,<span class="st">&quot;Autobus_RTP&quot;</span>,<span class="st">&quot;Bicicleta&quot;</span>,<span class="st">&quot;Autobus&quot;</span>,<span class="st">&quot;Moto&quot;</span>,<span class="st">&quot;Trolebus&quot;</span>,<span class="st">&quot;Metrobus&quot;</span>,<span class="st">&quot;Tren_L&quot;</span>,<span class="st">&quot;Tren_S&quot;</span>,<span class="st">&quot;Caminar&quot;</span>,<span class="st">&quot;Mexicable&quot;</span>,<span class="st">&quot;Bicitaxi&quot;</span>,<span class="st">&quot;Mototaxi&quot;</span>,<span class="st">&quot;T.Escolar&quot;</span>,<span class="st">&quot;T.Personal&quot;</span>,<span class="st">&quot;otro&quot;</span>),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="dv">4</span>,<span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-36-1.png" width="960" /></p>
<p><br></p>
<p>Se calculan las distancias <span class="math inline">\(\chi^2\)</span> de cada renglón de R a su centroide: (Ra-c)’Dc^-1(Ra-c).</p>
<p><br></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>dist.chicua.ren<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">apply</span>((<span class="fu">t</span>(table.pro)<span class="sc">-</span>ctot)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>ctot,<span class="dv">2</span>,sum))</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>dist.chicua.ren</span></code></pre></div>
<pre><code>##         1         2         3         4 
## 0.3184820 0.1608441 0.1374570 0.6876770</code></pre>
<p><br></p>
<p>Se calcula la inercia de cada renglón, que se obtiene multiplicando las distancia chi cuadrada a su centroide (al cuadrado) por su masa correspondiente:</p>
<p><br></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>inercia.ren<span class="ot">&lt;-</span>((dist.chicua.ren)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span>rtot</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>inercia.ren</span></code></pre></div>
<pre><code>##            1            2            3            4 
## 0.0009420589 0.0149879194 0.0058415597 0.0483338298</code></pre>
<p><br></p>
<p>Se calculan las distancias <span class="math inline">\(\chi^2\)</span> de cada columna de R a su centroide: (Ra-r)’Dr^-1(Ra-r).</p>
<p><br></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>dist.chicua.col<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">apply</span>(((table.pcol)<span class="sc">-</span>rtot)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>rtot,<span class="dv">2</span>,sum))</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>dist.chicua.col</span></code></pre></div>
<pre><code>##          1          2          3          4          5          6          7          8          9 
## 0.61608834 0.15369696 0.80565759 0.14659259 0.13516225 0.12749221 0.34675190 0.14778861 0.20130303 
##         10         11         12         13         14         15         16         17         18 
## 0.51643655 0.31177375 0.08529338 0.40846613 0.10488502 0.85212204 0.15597418 0.46290736 0.57217403 
##         19         20 
## 0.16370398 0.41650732</code></pre>
<p><br></p>
<p>Se calcula la inercia de cada columna, que se obtiene multiplicando las distancia <span class="math inline">\(\chi^2\)</span> a su centroide (al cuadrado) por su masa correspondiente:</p>
<p><br></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>inercia.col<span class="ot">&lt;-</span>((dist.chicua.col)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span>ctot</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>inercia.col</span></code></pre></div>
<pre><code>##            1            2            3            4            5            6            7 
## 4.786853e-02 5.847239e-03 2.017029e-03 6.309679e-04 1.383697e-03 1.132828e-04 1.613601e-03 
##            8            9           10           11           12           13           14 
## 3.550059e-04 2.616764e-04 5.994365e-04 1.766188e-03 1.304310e-05 4.783857e-04 4.826808e-03 
##           15           16           17           18           19           20 
## 1.051571e-04 4.227869e-05 1.061134e-03 9.611100e-04 1.609598e-05 1.447036e-04</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(inercia.ren)</span></code></pre></div>
<pre><code>## [1] 0.07010537</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(inercia.col)</span></code></pre></div>
<pre><code>## [1] 0.07010537</code></pre>
<p><br> <br></p>
<p>Ahora vamos usar la función “ca” de R para realizar análisis de correspondencia sobre la misma tabla de contingencia.</p>
<p><strong>Nota:</strong> Esta función trabaja directamente con la matriz tabla_T, la cual ya no tiene un valor propio de 1.</p>
<p><br></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>corres<span class="ot">&lt;-</span><span class="fu">ca</span>(tabla_T, <span class="at">nd =</span> <span class="dv">2</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>Cr1<span class="ot">&lt;-</span>corres<span class="sc">$</span>rowcoord <span class="co">#coordenadas de las filas</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>Cc1<span class="ot">&lt;-</span>corres<span class="sc">$</span>colcoord  <span class="co">#coordenadas de las columnas</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(corres,<span class="at">main=</span><span class="st">&quot;Encuesta Origen Destino 2017&quot;</span>,<span class="at">cex.main=</span><span class="dv">2</span>,<span class="at">sub=</span><span class="st">&quot;Análisis de Correspondencia Estrato vs Tipo de Transporte&quot;</span>,<span class="at">cex.sub=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-41-1.png" width="768" /></p>
<p><br></p>
<p>Se obtiene la representacion conjunta de los renglones y columnas en el espacio de dos dimensiones.</p>
<p><br></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Cr1,<span class="at">xlim=</span><span class="fu">range</span>(Cr1[,<span class="dv">1</span>],Cc1[,<span class="dv">1</span>]),<span class="at">ylim=</span><span class="fu">range</span>(Cr1[,<span class="dv">1</span>],Cc1[,<span class="dv">1</span>]),</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Coordenada 1&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Coordenada 2&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">main=</span><span class="st">&quot;Encuesta Origen Destino 2017&quot;</span>,<span class="at">cex.main=</span><span class="dv">2</span>,<span class="at">sub=</span><span class="st">&quot;Análisís de Correspondencia Estrato vs Tipo de Transporte&quot;</span>,<span class="at">cex.sub=</span><span class="fl">1.5</span>)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Cc1,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(Cr1,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Bajo&quot;</span>,<span class="st">&quot;Medio Bajo&quot;</span>,<span class="st">&quot;Medio Alto&quot;</span>,<span class="st">&quot;Alto&quot;</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(Cc1,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Automovil&quot;</span>,<span class="st">&quot;Colectivo&quot;</span>,<span class="st">&quot;Taxi_I&quot;</span>,<span class="st">&quot;Taxi_S,&quot;</span>,<span class="st">&quot;Metro&quot;</span>,<span class="st">&quot;Autobus_RTP&quot;</span>,<span class="st">&quot;Bicicleta&quot;</span>,<span class="st">&quot;Autobus&quot;</span>,<span class="st">&quot;Moto&quot;</span>,<span class="st">&quot;Trolebus&quot;</span>,<span class="st">&quot;Metrobus&quot;</span>,<span class="st">&quot;Tren_L&quot;</span>,<span class="st">&quot;Tren_S&quot;</span>,<span class="st">&quot;Caminar&quot;</span>,<span class="st">&quot;Mexicable&quot;</span>,<span class="st">&quot;Bicitaxi&quot;</span>,<span class="st">&quot;Mototaxi&quot;</span>,<span class="st">&quot;T.Escolar&quot;</span>,<span class="st">&quot;T.Personal&quot;</span>,<span class="st">&quot;otro&quot;</span>),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="dv">4</span>,<span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-42-1.png" width="960" /></p>
<p><br></p>
<p>Las proyecciones por filas, columnas y conjuntas de filas y columnas; comprueban que en la proyección por filas,las categorías están claramente separadas. En la variable del estrato, las primeras categorías de bajo y medio bajo están muy cercanas. Sin embargo, el estrato medio alto y alto estan separados. El tipo de transporte está también muy claramente identificado en la correspondencia a cada estrato socioecónomico.</p>
<p>En el caso del estrato alto se observa claramente la correspondencia con el automóvil.</p>
<p>En el estrato bajo hay una correspondecia cercana al colectivo, bicitaxi, autobús y moto. Para el estrato medio bajo, hay correspondencia cercana a los del estrato bajo.</p>
<p>En el estrato medio alto hay una correspondecia cercana al metro, taxi de sitio y autobús RTP y tren ligero.</p>
<p><br> <br> <br></p>
</div>
</div>
<div id="análisis-de-correlación-canónica-de-variables-seleccionadas." class="section level2">
<h2><strong>5. Análisis de Correlación Canónica de variables seleccionadas.</strong></h2>
<p><br></p>
<div id="metodología.-4" class="section level3">
<h3>Metodología.</h3>
<p><br></p>
<p>El análisis de correlación canónica es utilizado cuando un conjunto de variables se puede dividir en dos grupos homogéneos en función de algún criterio ya sea económico, demográfico, social, etc., y se desea estudiar la relación entre ambos conjuntos de variables, así como cuantificar el número de dimensiones independientes existentes en esta relación.</p>
<p>En específico se analizan dos conjuntos de variables sociodemográficas de las personas que viajan, las cuales corresponden a sexo y parentesco existente con el jefe del hogar; dichos conjuntos de variables son de las entidades: Ciudad de México, Hidalgo y México, que conforman la zona Metropolitana del Valle de México.</p>
<p>Cargamos las librerías utilizadas:</p>
<p><br></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#librerías utilizadas:</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install_github(&quot;ggobi/ggally&quot;)</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fields)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CCA)</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co">#update.packages(checkBuilt = TRUE, ask = FALSE)</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;vegan&quot;,dependence=TRUE)</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;ade4&quot;,dependence=TRUE)</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(permute)</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;devtools&quot;)</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github(&quot;calligross/ggthemeassist&quot;)</span></span></code></pre></div>
<p><br></p>
<p>Se leen y preparan los datos:</p>
<p><br></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se leen los datos:</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>datosCCP<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;bd/Tablas.xlsx&quot;</span>,<span class="at">sheet=</span><span class="st">&quot;parentesco&quot;</span>)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Se establece el grupo de datos de parentesco:</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>Dparentesco<span class="ot">&lt;-</span>datosCCP</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>Dparentesco<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(datosCCP)</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>Dparentesco</span></code></pre></div>
<pre><code>##            Entidad Esposo_companiero  Hijo  Jefe Nieto Otro_parentesco Sin_parentesco
## 1 Ciudad de Mexico             14586 29807 24895  5823            7231            830
## 2          Hidalgo               202   449   283    52              52              3
## 3           Mexico             21857 46102 31507  7598            8349            491</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se establece el grupo de datos de sexo:</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>datosCCS<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;bd/Tablas.xlsx&quot;</span>,<span class="at">sheet=</span><span class="st">&quot;sexo&quot;</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>Dsexo<span class="ot">&lt;-</span>datosCCS</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>Dsexo<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(datosCCS)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>Dsexo</span></code></pre></div>
<pre><code>##            Entidad Hombre Mujer
## 1 Ciudad de Mexico  39769 43403
## 2          Hidalgo    492   549
## 3           Mexico  56560 59344</code></pre>
<p><br></p>
</div>
<div id="resultados" class="section level3">
<h3>Resultados</h3>
<p><br></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se grafican los grupos de variables:</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(Dsexo, <span class="at">title =</span> <span class="st">&quot;Sexo de la persona que viaja&quot;</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(Dparentesco, <span class="at">title =</span> <span class="st">&quot;Parentesco con respecto al jefe del hogar&quot;</span>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-45-2.png" width="672" /></p>
<p><br></p>
<p>Como se puede observar se grafican en forma de matriz cada conjunto de datos con sus variables, este resultado es una correlación de las variables elegidas. Este tipo de gráfica nos provee de dos comparaciones diferentes por cada par de columnas que han sido seleccionadas.</p>
<p><br></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Se unifican ambos conjuntos en uno solo para graficar:</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>sitios <span class="ot">&lt;-</span><span class="fu">cbind</span>(Dparentesco,Dsexo[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>sitios</span></code></pre></div>
<pre><code>##            Entidad Esposo_companiero  Hijo  Jefe Nieto Otro_parentesco Sin_parentesco Hombre Mujer
## 1 Ciudad de Mexico             14586 29807 24895  5823            7231            830  39769 43403
## 2          Hidalgo               202   449   283    52              52              3    492   549
## 3           Mexico             21857 46102 31507  7598            8349            491  56560 59344</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggduo</span>(sitios,<span class="at">columnsX =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="at">columnsY =</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">types =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">&quot;smooth_lm&quot;</span>),</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Correlaci?n entre variables de sexo y parentesco&quot;</span>,</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Parentesco&quot;</span>,</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Sexo&quot;</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p><br></p>
<p>La gráfica permite obtener y visualizar la correlación entre los dos conjuntos de variables referentes a sexo y parentesco.</p>
<p>Se generan las matrices para los cálculos posteriores:</p>
<p><br></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(Dsexo[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="at">dimnames =</span> <span class="cn">NULL</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>Y</span></code></pre></div>
<pre><code>##      Hombre Mujer
## [1,]  39769 43403
## [2,]    492   549
## [3,]  56560 59344</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(Dparentesco[,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>],<span class="at">dimnames =</span> <span class="cn">NULL</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>##      Esposo_companiero  Hijo  Jefe Nieto Otro_parentesco Sin_parentesco
## [1,]             14586 29807 24895  5823            7231            830
## [2,]               202   449   283    52              52              3
## [3,]             21857 46102 31507  7598            8349            491</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se procede a calcular las matrices de correlación dentro </span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># y entre los dos conjuntos de datos.</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>mat_CC  <span class="ot">&lt;-</span><span class="fu">matcor</span>(X,Y)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>mat_CC</span></code></pre></div>
<pre><code>## $Xcor
##                   Esposo_companiero      Hijo      Jefe     Nieto Otro_parentesco Sin_parentesco
## Esposo_companiero         1.0000000 0.9997193 0.9910512 0.9940332       0.9776741      0.7274944
## Hijo                      0.9997193 1.0000000 0.9876106 0.9911699       0.9724215      0.7110351
## Jefe                      0.9910512 0.9876106 1.0000000 0.9996978       0.9969733      0.8125682
## Nieto                     0.9940332 0.9911699 0.9996978 1.0000000       0.9947608      0.7979936
## Otro_parentesco           0.9776741 0.9724215 0.9969733 0.9947608       1.0000000      0.8554233
## Sin_parentesco            0.7274944 0.7110351 0.8125682 0.7979936       0.8554233      1.0000000
## 
## $Ycor
##           Hombre     Mujer
## Hombre 1.0000000 0.9995246
## Mujer  0.9995246 1.0000000
## 
## $XYcor
##                   Esposo_companiero      Hijo      Jefe     Nieto Otro_parentesco Sin_parentesco
## Esposo_companiero         1.0000000 0.9997193 0.9910512 0.9940332       0.9776741      0.7274944
## Hijo                      0.9997193 1.0000000 0.9876106 0.9911699       0.9724215      0.7110351
## Jefe                      0.9910512 0.9876106 1.0000000 0.9996978       0.9969733      0.8125682
## Nieto                     0.9940332 0.9911699 0.9996978 1.0000000       0.9947608      0.7979936
## Otro_parentesco           0.9776741 0.9724215 0.9969733 0.9947608       1.0000000      0.8554233
## Sin_parentesco            0.7274944 0.7110351 0.8125682 0.7979936       0.8554233      1.0000000
## Hombre                    0.9991953 0.9979646 0.9956075 0.9976083       0.9853154      0.7544283
## Mujer                     0.9974838 0.9955242 0.9980207 0.9992651       0.9901111      0.7743061
##                      Hombre     Mujer
## Esposo_companiero 0.9991953 0.9974838
## Hijo              0.9979646 0.9955242
## Jefe              0.9956075 0.9980207
## Nieto             0.9976083 0.9992651
## Otro_parentesco   0.9853154 0.9901111
## Sin_parentesco    0.7544283 0.7743061
## Hombre            1.0000000 0.9995246
## Mujer             0.9995246 1.0000000</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>Datoscca<span class="ot">&lt;-</span> <span class="fu">cca</span>(X,Y)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>Datoscca</span></code></pre></div>
<pre><code>## Call: cca(X = X, Y = Y)
## 
##                Inertia Proportion Rank
## Total         0.003953   1.000000     
## Constrained   0.003953   1.000000    2
## Unconstrained 0.000000   0.000000    0
## Inertia is scaled Chi-square 
## 
## Eigenvalues for constrained axes:
##     CCA1     CCA2 
## 0.003919 0.000033</code></pre>
<p><br></p>
<p>Podemos observar que “Total Inertia” o varianza total en las distribuciones de los grupos de datos es relativamente pequeña así como los resultados de los eigenvalores que representan la cantidad de varianza explicada por cada eje CCA o restringida y la suma de ambos eigenvalores es el valor de “Constrained Inertia”.</p>
<p><br></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Datoscca,<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="cap1_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p><br></p>
<p>En el gráfico se observa como en el eje existe una elevación creciente tanto para la variable mujer como para hombre.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
